/* Define file locations */
%let curr_folder = '/path/to/curr/';
%let prev_folder = '/path/to/prev/';

/* Iterate through files in curr folder */
filename curr "&curr_folder";
filename prev "&prev_folder.";

data _null_;
    /* Loop through each file in curr folder */
    dir_id = dopen('curr');
    if dir_id > 0 then do;
        do i = 1 to dnum(dir_id);
            /* Get file name */
            curr_file = dread(dir_id, i);
            
            /* Check if file exists in prev folder */
            if fileexist(cats("&prev_folder.", curr_file)) then do;
                /* Overwrite file in prev folder */
                put "Overwriting file: " curr_file;
                infile curr(curr_file) recfm=n;
                file prev(curr_file) recfm=n;
                input;
                put _infile_;
                /* Close files */
                infile curr;
                file prev;
            end;
            else do;
                /* Move file from curr to prev folder */
                put "Moving file: " curr_file;
                rc = filename('temp', cats("&curr_folder.", curr_file));
                rc = fcopy('temp', 'prev');
                rc = filename('temp');
            end;
        end;
        /* Close directory */
        rc = dclose(dir_id);
    end;
    else put "Error: Unable to open directory.";
run;
